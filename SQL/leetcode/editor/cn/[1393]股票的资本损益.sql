#Stocks è¡¨ï¼š 
#
# +---------------+---------+
#| Column Name   | Type    |
#+---------------+---------+
#| stock_name    | varchar |
#| operation     | enum    |
#| operation_day | int     |
#| price         | int     |
#+---------------+---------+
#(stock_name, day) æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®
#operation åˆ—ä½¿ç”¨çš„æ˜¯ä¸€ç§æšä¸¾ç±»å‹ï¼ŒåŒ…æ‹¬ï¼š('Sell','Buy')
#æ­¤è¡¨çš„æ¯ä¸€è¡Œä»£è¡¨äº†åä¸º stock_name çš„æŸæ”¯è‚¡ç¥¨åœ¨ operation_day è¿™ä¸€å¤©çš„æ“ä½œä»·æ ¼ã€‚
#ä¿è¯è‚¡ç¥¨çš„æ¯æ¬¡'Sell'æ“ä½œå‰ï¼Œéƒ½æœ‰ç›¸åº”çš„'Buy'æ“ä½œã€‚
# 
#
# 
#
# ç¼–å†™ä¸€ä¸ªSQLæŸ¥è¯¢æ¥æŠ¥å‘Šæ¯æ”¯è‚¡ç¥¨çš„èµ„æœ¬æŸç›Šã€‚ 
#
# è‚¡ç¥¨çš„èµ„æœ¬æŸç›Šæ˜¯ä¸€æ¬¡æˆ–å¤šæ¬¡ä¹°å–è‚¡ç¥¨åçš„å…¨éƒ¨æ”¶ç›Šæˆ–æŸå¤±ã€‚ 
#
# ä»¥ä»»æ„é¡ºåºè¿”å›ç»“æœå³å¯ã€‚ 
#
# SQLæŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š 
#
# Stocks è¡¨:
#+---------------+-----------+---------------+--------+
#| stock_name    | operation | operation_day | price  |
#+---------------+-----------+---------------+--------+
#| Leetcode      | Buy       | 1             | 1000   |
#| Corona Masks  | Buy       | 2             | 10     |
#| Leetcode      | Sell      | 5             | 9000   |
#| Handbags      | Buy       | 17            | 30000  |
#| Corona Masks  | Sell      | 3             | 1010   |
#| Corona Masks  | Buy       | 4             | 1000   |
#| Corona Masks  | Sell      | 5             | 500    |
#| Corona Masks  | Buy       | 6             | 1000   |
#| Handbags      | Sell      | 29            | 7000   |
#| Corona Masks  | Sell      | 10            | 10000  |
#+---------------+-----------+---------------+--------+
#
#Result è¡¨:
#+---------------+-------------------+
#| stock_name    | capital_gain_loss |
#+---------------+-------------------+
#| Corona Masks  | 9500              |
#| Leetcode      | 8000              |
#| Handbags      | -23000            |
#+---------------+-------------------+
#Leetcode è‚¡ç¥¨åœ¨ç¬¬ä¸€å¤©ä»¥1000ç¾å…ƒçš„ä»·æ ¼ä¹°å…¥ï¼Œåœ¨ç¬¬äº”å¤©ä»¥9000ç¾å…ƒçš„ä»·æ ¼å–å‡ºã€‚èµ„æœ¬æ”¶ç›Š=9000-1000=8000ç¾å…ƒã€‚
#Handbags è‚¡ç¥¨åœ¨ç¬¬17å¤©ä»¥30000ç¾å…ƒçš„ä»·æ ¼ä¹°å…¥ï¼Œåœ¨ç¬¬29å¤©ä»¥7000ç¾å…ƒçš„ä»·æ ¼å–å‡ºã€‚èµ„æœ¬æŸå¤±=7000-30000=-23000ç¾å…ƒã€‚
#Corona Masks è‚¡ç¥¨åœ¨ç¬¬1å¤©ä»¥10ç¾å…ƒçš„ä»·æ ¼ä¹°å…¥ï¼Œåœ¨ç¬¬3å¤©ä»¥1010ç¾å…ƒçš„ä»·æ ¼å–å‡ºã€‚åœ¨ç¬¬4å¤©ä»¥1000ç¾å…ƒçš„ä»·æ ¼å†æ¬¡è´­ä¹°ï¼Œåœ¨ç¬¬5å¤©ä»¥500ç¾å…ƒçš„ä»·æ ¼
#å‡ºå”®ã€‚æœ€åï¼Œå®ƒåœ¨ç¬¬6å¤©ä»¥1000ç¾å…ƒçš„ä»·æ ¼è¢«ä¹°èµ°ï¼Œåœ¨ç¬¬10å¤©ä»¥10000ç¾å…ƒçš„ä»·æ ¼è¢«å–æ‰ã€‚èµ„æœ¬æŸç›Šæ˜¯æ¯æ¬¡ï¼ˆâ€™Buy'->'Sell'ï¼‰æ“ä½œèµ„æœ¬æ”¶ç›Šæˆ–æŸå¤±çš„å’Œ=ï¼ˆ
#1010-10ï¼‰+ï¼ˆ500-1000ï¼‰+ï¼ˆ10000-1000ï¼‰=1000-500+9000=9500ç¾å…ƒã€‚
# 
#
# Related Topics æ•°æ®åº“ ğŸ‘ 55 ğŸ‘ 0


#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below
select stock_name,
       sum(case when operation = 'Buy' then -price when operation = 'Sell' then price end) as capital_gain_loss
from Stocks
group by stock_name;
#leetcode submit region end(Prohibit modification and deletion)
